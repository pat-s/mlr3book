<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.7 Advanced: An in-depth look into mlr3pipelines | mlr3book.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="4.7 Advanced: An in-depth look into mlr3pipelines | mlr3book.utf8" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://mlr3book.mlr-org.com/" />
  <meta property="og:image" content="https://mlr3book.mlr-org.com/block.png" />
  
  <meta name="github-repo" content="mlr-org/mlr3book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.7 Advanced: An in-depth look into mlr3pipelines | mlr3book.utf8" />
  
  
  <meta name="twitter:image" content="https://mlr3book.mlr-org.com/block.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="apple-touch-icon.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="pipe-special-ops.html"/>
<link rel="next" href="technical.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">mlr3 Manual <img src='https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png' width=30 /></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Quickstart</a></li>
<li class="chapter" data-level="1" data-path="introduction-and-overview.html"><a href="introduction-and-overview.html"><i class="fa fa-check"></i><b>1</b> Introduction and Overview</a></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basics</a><ul>
<li class="chapter" data-level="2.1" data-path="r6.html"><a href="r6.html"><i class="fa fa-check"></i><b>2.1</b> Quick R6 Intro for Beginners</a></li>
<li class="chapter" data-level="2.2" data-path="tasks.html"><a href="tasks.html"><i class="fa fa-check"></i><b>2.2</b> Tasks</a><ul>
<li class="chapter" data-level="2.2.1" data-path="tasks.html"><a href="tasks.html#tasks-types"><i class="fa fa-check"></i><b>2.2.1</b> Task Types</a></li>
<li class="chapter" data-level="2.2.2" data-path="tasks.html"><a href="tasks.html#tasks-creation"><i class="fa fa-check"></i><b>2.2.2</b> Task Creation</a></li>
<li class="chapter" data-level="2.2.3" data-path="tasks.html"><a href="tasks.html#tasks-predefined"><i class="fa fa-check"></i><b>2.2.3</b> Predefined tasks</a></li>
<li class="chapter" data-level="2.2.4" data-path="tasks.html"><a href="tasks.html#tasks-api"><i class="fa fa-check"></i><b>2.2.4</b> Task API</a><ul>
<li class="chapter" data-level="2.2.4.1" data-path="tasks.html"><a href="tasks.html#tasks-retrieving"><i class="fa fa-check"></i><b>2.2.4.1</b> Retrieving Data</a></li>
<li class="chapter" data-level="2.2.4.2" data-path="tasks.html"><a href="tasks.html#tasks-roles"><i class="fa fa-check"></i><b>2.2.4.2</b> Roles (Rows and Columns)</a></li>
<li class="chapter" data-level="2.2.4.3" data-path="tasks.html"><a href="tasks.html#tasks-mutators"><i class="fa fa-check"></i><b>2.2.4.3</b> Task Mutators</a></li>
</ul></li>
<li class="chapter" data-level="2.2.5" data-path="tasks.html"><a href="tasks.html#autoplot-task"><i class="fa fa-check"></i><b>2.2.5</b> Plotting Tasks</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="learners.html"><a href="learners.html"><i class="fa fa-check"></i><b>2.3</b> Learners</a><ul>
<li class="chapter" data-level="2.3.1" data-path="learners.html"><a href="learners.html#learners-predefined"><i class="fa fa-check"></i><b>2.3.1</b> Predefined Learners</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="train-predict.html"><a href="train-predict.html"><i class="fa fa-check"></i><b>2.4</b> Train and Predict</a><ul>
<li class="chapter" data-level="2.4.1" data-path="train-predict.html"><a href="train-predict.html#train-predict-objects"><i class="fa fa-check"></i><b>2.4.1</b> Creating Task and Learner Objects</a></li>
<li class="chapter" data-level="2.4.2" data-path="train-predict.html"><a href="train-predict.html#split-data"><i class="fa fa-check"></i><b>2.4.2</b> Setting up the train/test splits of the data</a></li>
<li class="chapter" data-level="2.4.3" data-path="train-predict.html"><a href="train-predict.html#training"><i class="fa fa-check"></i><b>2.4.3</b> Training the learner</a></li>
<li class="chapter" data-level="2.4.4" data-path="train-predict.html"><a href="train-predict.html#predicting"><i class="fa fa-check"></i><b>2.4.4</b> Predicting</a></li>
<li class="chapter" data-level="2.4.5" data-path="train-predict.html"><a href="train-predict.html#predict-type"><i class="fa fa-check"></i><b>2.4.5</b> Changing the Predict Type</a></li>
<li class="chapter" data-level="2.4.6" data-path="train-predict.html"><a href="train-predict.html#autoplot-prediction"><i class="fa fa-check"></i><b>2.4.6</b> Plotting Predictions</a></li>
<li class="chapter" data-level="2.4.7" data-path="train-predict.html"><a href="train-predict.html#measure"><i class="fa fa-check"></i><b>2.4.7</b> Performance assessment</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="resampling.html"><a href="resampling.html"><i class="fa fa-check"></i><b>2.5</b> Resampling</a><ul>
<li class="chapter" data-level="2.5.1" data-path="resampling.html"><a href="resampling.html#resampling-settings"><i class="fa fa-check"></i><b>2.5.1</b> Settings</a></li>
<li class="chapter" data-level="2.5.2" data-path="resampling.html"><a href="resampling.html#resampling-inst"><i class="fa fa-check"></i><b>2.5.2</b> Instantiation</a></li>
<li class="chapter" data-level="2.5.3" data-path="resampling.html"><a href="resampling.html#resampling-exec"><i class="fa fa-check"></i><b>2.5.3</b> Execution</a></li>
<li class="chapter" data-level="2.5.4" data-path="resampling.html"><a href="resampling.html#resamp-custom"><i class="fa fa-check"></i><b>2.5.4</b> Custom resampling</a></li>
<li class="chapter" data-level="2.5.5" data-path="resampling.html"><a href="resampling.html#autoplot-resampleresult"><i class="fa fa-check"></i><b>2.5.5</b> Plotting Resample Results</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="benchmarking.html"><a href="benchmarking.html"><i class="fa fa-check"></i><b>2.6</b> Benchmarking</a><ul>
<li class="chapter" data-level="2.6.1" data-path="benchmarking.html"><a href="benchmarking.html#bm-design"><i class="fa fa-check"></i><b>2.6.1</b> Design Creation</a></li>
<li class="chapter" data-level="2.6.2" data-path="benchmarking.html"><a href="benchmarking.html#bm-exec"><i class="fa fa-check"></i><b>2.6.2</b> Execution and Aggregation of Results</a></li>
<li class="chapter" data-level="2.6.3" data-path="benchmarking.html"><a href="benchmarking.html#autoplot-benchmarkresult"><i class="fa fa-check"></i><b>2.6.3</b> Plotting Benchmark Results</a></li>
<li class="chapter" data-level="2.6.4" data-path="benchmarking.html"><a href="benchmarking.html#bm-resamp"><i class="fa fa-check"></i><b>2.6.4</b> Extracting ResampleResults</a></li>
<li class="chapter" data-level="2.6.5" data-path="benchmarking.html"><a href="benchmarking.html#converting-and-merging-resampleresults"><i class="fa fa-check"></i><b>2.6.5</b> Converting and Merging ResampleResults</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="binary.html"><a href="binary.html"><i class="fa fa-check"></i><b>2.7</b> Binary classification</a><ul>
<li class="chapter" data-level="2.7.1" data-path="binary.html"><a href="binary.html#binary-roc"><i class="fa fa-check"></i><b>2.7.1</b> ROC Curve and Thresholds</a></li>
<li class="chapter" data-level="2.7.2" data-path="binary.html"><a href="binary.html#threshold-tuning"><i class="fa fa-check"></i><b>2.7.2</b> Threshold Tuning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="model-optim.html"><a href="model-optim.html"><i class="fa fa-check"></i><b>3</b> Model Optimization</a><ul>
<li class="chapter" data-level="3.1" data-path="tuning.html"><a href="tuning.html"><i class="fa fa-check"></i><b>3.1</b> Hyperparameter Tuning</a><ul>
<li class="chapter" data-level="3.1.1" data-path="tuning.html"><a href="tuning.html#tuning-optimization"><i class="fa fa-check"></i><b>3.1.1</b> The <code>TuningInstance</code> Class</a></li>
<li class="chapter" data-level="3.1.2" data-path="tuning.html"><a href="tuning.html#the-tuner-class"><i class="fa fa-check"></i><b>3.1.2</b> The <code>Tuner</code> Class</a></li>
<li class="chapter" data-level="3.1.3" data-path="tuning.html"><a href="tuning.html#tuning-triggering"><i class="fa fa-check"></i><b>3.1.3</b> Triggering the Tuning</a></li>
<li class="chapter" data-level="3.1.4" data-path="tuning.html"><a href="tuning.html#autotuner"><i class="fa fa-check"></i><b>3.1.4</b> Automating the Tuning</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="fs.html"><a href="fs.html"><i class="fa fa-check"></i><b>3.2</b> Feature Selection / Filtering</a><ul>
<li class="chapter" data-level="3.2.1" data-path="fs.html"><a href="fs.html#fs-filter"><i class="fa fa-check"></i><b>3.2.1</b> Filters</a></li>
<li class="chapter" data-level="3.2.2" data-path="fs.html"><a href="fs.html#fs-calc"><i class="fa fa-check"></i><b>3.2.2</b> Calculating filter values</a></li>
<li class="chapter" data-level="3.2.3" data-path="fs.html"><a href="fs.html#fs-var-imp-filters"><i class="fa fa-check"></i><b>3.2.3</b> Variable Importance Filters</a></li>
<li class="chapter" data-level="3.2.4" data-path="fs.html"><a href="fs.html#fs-ensemble"><i class="fa fa-check"></i><b>3.2.4</b> Ensemble Methods</a></li>
<li class="chapter" data-level="3.2.5" data-path="fs.html"><a href="fs.html#fs-wrapper"><i class="fa fa-check"></i><b>3.2.5</b> Wrapper Methods</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="nested-resampling.html"><a href="nested-resampling.html"><i class="fa fa-check"></i><b>3.3</b> Nested Resampling</a><ul>
<li class="chapter" data-level="3.3.1" data-path="nested-resampling.html"><a href="nested-resampling.html#nested-resamp-exec"><i class="fa fa-check"></i><b>3.3.1</b> Execution</a></li>
<li class="chapter" data-level="3.3.2" data-path="nested-resampling.html"><a href="nested-resampling.html#nested-resamp-eval"><i class="fa fa-check"></i><b>3.3.2</b> Evaluation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pipelines.html"><a href="pipelines.html"><i class="fa fa-check"></i><b>4</b> Pipelines</a><ul>
<li class="chapter" data-level="4.1" data-path="the-building-blocks-pipeops.html"><a href="the-building-blocks-pipeops.html"><i class="fa fa-check"></i><b>4.1</b> The Building Blocks: PipeOps</a></li>
<li class="chapter" data-level="4.2" data-path="pipe-operator.html"><a href="pipe-operator.html"><i class="fa fa-check"></i><b>4.2</b> The Pipeline Operator: <code>%&gt;&gt;%</code></a></li>
<li class="chapter" data-level="4.3" data-path="pipe-nodes-edges-graphs.html"><a href="pipe-nodes-edges-graphs.html"><i class="fa fa-check"></i><b>4.3</b> Nodes, Edges and Graphs</a></li>
<li class="chapter" data-level="4.4" data-path="pipe-modeling.html"><a href="pipe-modeling.html"><i class="fa fa-check"></i><b>4.4</b> Modeling</a><ul>
<li class="chapter" data-level="4.4.1" data-path="pipe-modeling.html"><a href="pipe-modeling.html#pipe-hyperpars"><i class="fa fa-check"></i><b>4.4.1</b> Setting Hyperparameters</a></li>
<li class="chapter" data-level="4.4.2" data-path="pipe-modeling.html"><a href="pipe-modeling.html#pipe-tuning"><i class="fa fa-check"></i><b>4.4.2</b> Tuning</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html"><i class="fa fa-check"></i><b>4.5</b> Non-Linear Graphs</a><ul>
<li class="chapter" data-level="4.5.1" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#pipe-model-ensembles-branching-copying"><i class="fa fa-check"></i><b>4.5.1</b> Branching &amp; Copying</a></li>
<li class="chapter" data-level="4.5.2" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#pipe-model-ensembles"><i class="fa fa-check"></i><b>4.5.2</b> Model Ensembles</a><ul>
<li class="chapter" data-level="4.5.2.1" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#pipe-model-ensembles-bagging"><i class="fa fa-check"></i><b>4.5.2.1</b> Bagging</a></li>
<li class="chapter" data-level="4.5.2.2" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#pipe-model-ensembles-stacking"><i class="fa fa-check"></i><b>4.5.2.2</b> Stacking</a></li>
<li class="chapter" data-level="4.5.2.3" data-path="pipe-nonlinear.html"><a href="pipe-nonlinear.html#multilevel-stacking"><i class="fa fa-check"></i><b>4.5.2.3</b> Multilevel Stacking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html"><i class="fa fa-check"></i><b>4.6</b> Special Operators</a><ul>
<li class="chapter" data-level="4.6.1" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#imputation-pipeopimpute"><i class="fa fa-check"></i><b>4.6.1</b> Imputation: <code>PipeOpImpute</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#feature-engineering-pipeopmutate"><i class="fa fa-check"></i><b>4.6.2</b> Feature Engineering: <code>PipeOpMutate</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#training-on-data-subsets-pipeopchunk"><i class="fa fa-check"></i><b>4.6.3</b> Training on data subsets: <code>PipeOpChunk</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="pipe-special-ops.html"><a href="pipe-special-ops.html#feature-selection-pipeopfilter-and-pipeopselect"><i class="fa fa-check"></i><b>4.6.4</b> Feature Selection: <code>PipeOpFilter</code> and <code>PipeOpSelect</code></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html"><i class="fa fa-check"></i><b>4.7</b> Advanced: An in-depth look into mlr3pipelines</a><ul>
<li class="chapter" data-level="4.7.1" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#whats-the-point"><i class="fa fa-check"></i><b>4.7.1</b> What’s the Point</a></li>
<li class="chapter" data-level="4.7.2" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#pipeop-pipeline-operators"><i class="fa fa-check"></i><b>4.7.2</b> <code>PipeOp</code>: Pipeline Operators</a><ul>
<li class="chapter" data-level="4.7.2.1" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#why-the-state"><i class="fa fa-check"></i><b>4.7.2.1</b> Why the <code>$state</code></a></li>
<li class="chapter" data-level="4.7.2.2" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#where-to-get-pipeops"><i class="fa fa-check"></i><b>4.7.2.2</b> Where to Get <code>PipeOp</code>s</a></li>
</ul></li>
<li class="chapter" data-level="4.7.3" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#pipeop-channels"><i class="fa fa-check"></i><b>4.7.3</b> PipeOp Channels</a><ul>
<li class="chapter" data-level="4.7.3.1" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#input-channels"><i class="fa fa-check"></i><b>4.7.3.1</b> Input Channels</a></li>
<li class="chapter" data-level="4.7.3.2" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#output-channels"><i class="fa fa-check"></i><b>4.7.3.2</b> Output Channels</a></li>
<li class="chapter" data-level="4.7.3.3" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#channel-configuration"><i class="fa fa-check"></i><b>4.7.3.3</b> Channel Configuration</a></li>
</ul></li>
<li class="chapter" data-level="4.7.4" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#graph-networks-of-pipeops"><i class="fa fa-check"></i><b>4.7.4</b> <code>Graph</code>: Networks of <code>PipeOp</code>s</a><ul>
<li class="chapter" data-level="4.7.4.1" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#basics-1"><i class="fa fa-check"></i><b>4.7.4.1</b> Basics</a></li>
<li class="chapter" data-level="4.7.4.2" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#networks"><i class="fa fa-check"></i><b>4.7.4.2</b> Networks</a></li>
<li class="chapter" data-level="4.7.4.3" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#syntactic-sugar"><i class="fa fa-check"></i><b>4.7.4.3</b> Syntactic Sugar</a></li>
<li class="chapter" data-level="4.7.4.4" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#pipeop-ids-and-id-name-clashes"><i class="fa fa-check"></i><b>4.7.4.4</b> <code>PipeOp</code> IDs and ID Name Clashes</a></li>
</ul></li>
<li class="chapter" data-level="4.7.5" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#learners-in-graphs-graphs-in-learners"><i class="fa fa-check"></i><b>4.7.5</b> Learners in Graphs, Graphs in Learners</a><ul>
<li class="chapter" data-level="4.7.5.1" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#pipeoplearner"><i class="fa fa-check"></i><b>4.7.5.1</b> <code>PipeOpLearner</code></a></li>
<li class="chapter" data-level="4.7.5.2" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#graphlearner"><i class="fa fa-check"></i><b>4.7.5.2</b> <code>GraphLearner</code></a></li>
</ul></li>
<li class="chapter" data-level="4.7.6" data-path="advanced-an-in-depth-look-into-mlr3pipelines.html"><a href="advanced-an-in-depth-look-into-mlr3pipelines.html#hyperparameters"><i class="fa fa-check"></i><b>4.7.6</b> Hyperparameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="technical.html"><a href="technical.html"><i class="fa fa-check"></i><b>5</b> Technical</a><ul>
<li class="chapter" data-level="5.1" data-path="parallelization.html"><a href="parallelization.html"><i class="fa fa-check"></i><b>5.1</b> Parallelization</a></li>
<li class="chapter" data-level="5.2" data-path="error-handling.html"><a href="error-handling.html"><i class="fa fa-check"></i><b>5.2</b> Error Handling</a><ul>
<li class="chapter" data-level="5.2.1" data-path="error-handling.html"><a href="error-handling.html#encapsulation"><i class="fa fa-check"></i><b>5.2.1</b> Encapsulation</a></li>
<li class="chapter" data-level="5.2.2" data-path="error-handling.html"><a href="error-handling.html#fallback-learners"><i class="fa fa-check"></i><b>5.2.2</b> Fallback learners</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="backends.html"><a href="backends.html"><i class="fa fa-check"></i><b>5.3</b> Database Backends</a><ul>
<li class="chapter" data-level="5.3.1" data-path="backends.html"><a href="backends.html#use-case-nyc-flights"><i class="fa fa-check"></i><b>5.3.1</b> Use Case: NYC Flights</a></li>
<li class="chapter" data-level="5.3.2" data-path="backends.html"><a href="backends.html#preprocessing-with-dplyr"><i class="fa fa-check"></i><b>5.3.2</b> Preprocessing with <code>dplyr</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="backends.html"><a href="backends.html#databackenddplyr"><i class="fa fa-check"></i><b>5.3.3</b> DataBackendDplyr</a></li>
<li class="chapter" data-level="5.3.4" data-path="backends.html"><a href="backends.html#model-fitting"><i class="fa fa-check"></i><b>5.3.4</b> Model fitting</a></li>
<li class="chapter" data-level="5.3.5" data-path="backends.html"><a href="backends.html#cleanup"><i class="fa fa-check"></i><b>5.3.5</b> Cleanup</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="paradox.html"><a href="paradox.html"><i class="fa fa-check"></i><b>5.4</b> Parameters (using <code>paradox</code>)</a><ul>
<li class="chapter" data-level="5.4.1" data-path="paradox.html"><a href="paradox.html#reference-based-objects"><i class="fa fa-check"></i><b>5.4.1</b> Reference Based Objects</a></li>
<li class="chapter" data-level="5.4.2" data-path="paradox.html"><a href="paradox.html#defining-a-parameter-space"><i class="fa fa-check"></i><b>5.4.2</b> Defining a Parameter Space</a><ul>
<li class="chapter" data-level="5.4.2.1" data-path="paradox.html"><a href="paradox.html#single-parameters"><i class="fa fa-check"></i><b>5.4.2.1</b> Single Parameters</a></li>
<li class="chapter" data-level="5.4.2.2" data-path="paradox.html"><a href="paradox.html#parameter-sets"><i class="fa fa-check"></i><b>5.4.2.2</b> Parameter Sets</a></li>
<li class="chapter" data-level="5.4.2.3" data-path="paradox.html"><a href="paradox.html#vector-parameters"><i class="fa fa-check"></i><b>5.4.2.3</b> Vector Parameters</a></li>
</ul></li>
<li class="chapter" data-level="5.4.3" data-path="paradox.html"><a href="paradox.html#parameter-sampling"><i class="fa fa-check"></i><b>5.4.3</b> Parameter Sampling</a><ul>
<li class="chapter" data-level="5.4.3.1" data-path="paradox.html"><a href="paradox.html#parameter-designs"><i class="fa fa-check"></i><b>5.4.3.1</b> Parameter Designs</a></li>
<li class="chapter" data-level="5.4.3.2" data-path="paradox.html"><a href="paradox.html#grid-design"><i class="fa fa-check"></i><b>5.4.3.2</b> Grid Design</a></li>
<li class="chapter" data-level="5.4.3.3" data-path="paradox.html"><a href="paradox.html#random-sampling"><i class="fa fa-check"></i><b>5.4.3.3</b> Random Sampling</a></li>
<li class="chapter" data-level="5.4.3.4" data-path="paradox.html"><a href="paradox.html#generalized-sampling-the-sampler-class"><i class="fa fa-check"></i><b>5.4.3.4</b> Generalized Sampling: The <code>Sampler</code> Class</a></li>
</ul></li>
<li class="chapter" data-level="5.4.4" data-path="paradox.html"><a href="paradox.html#parameter-transformation"><i class="fa fa-check"></i><b>5.4.4</b> Parameter Transformation</a><ul>
<li class="chapter" data-level="5.4.4.1" data-path="paradox.html"><a href="paradox.html#transformation-between-types"><i class="fa fa-check"></i><b>5.4.4.1</b> Transformation between Types</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="logging.html"><a href="logging.html"><i class="fa fa-check"></i><b>5.5</b> Logging and Verbosity</a><ul>
<li class="chapter" data-level="5.5.1" data-path="logging.html"><a href="logging.html#available-logging-levels"><i class="fa fa-check"></i><b>5.5.1</b> Available logging levels</a></li>
<li class="chapter" data-level="5.5.2" data-path="logging.html"><a href="logging.html#global-setting"><i class="fa fa-check"></i><b>5.5.2</b> Global Setting</a></li>
<li class="chapter" data-level="5.5.3" data-path="logging.html"><a href="logging.html#changing-mlr3-logging-levels"><i class="fa fa-check"></i><b>5.5.3</b> Changing mlr3 logging levels</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="transition.html"><a href="transition.html"><i class="fa fa-check"></i><b>5.6</b> mlr -&gt; mlr3 Transition Guide</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="extending.html"><a href="extending.html"><i class="fa fa-check"></i><b>6</b> Extending</a><ul>
<li class="chapter" data-level="6.1" data-path="extending-learners.html"><a href="extending-learners.html"><i class="fa fa-check"></i><b>6.1</b> Adding new Learners</a><ul>
<li class="chapter" data-level="6.1.1" data-path="extending-learners.html"><a href="extending-learners.html#learner-meta-information"><i class="fa fa-check"></i><b>6.1.1</b> Meta-information</a></li>
<li class="chapter" data-level="6.1.2" data-path="extending-learners.html"><a href="extending-learners.html#learner-train"><i class="fa fa-check"></i><b>6.1.2</b> Train function</a></li>
<li class="chapter" data-level="6.1.3" data-path="extending-learners.html"><a href="extending-learners.html#learner-predict"><i class="fa fa-check"></i><b>6.1.3</b> Predict function</a></li>
<li class="chapter" data-level="6.1.4" data-path="extending-learners.html"><a href="extending-learners.html#final-learner"><i class="fa fa-check"></i><b>6.1.4</b> Final learner</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="extending-pipeops.html"><a href="extending-pipeops.html"><i class="fa fa-check"></i><b>6.2</b> Adding new PipeOps</a><ul>
<li class="chapter" data-level="6.2.1" data-path="extending-pipeops.html"><a href="extending-pipeops.html#ext-pipeopcopy"><i class="fa fa-check"></i><b>6.2.1</b> General Case Example: <code>PipeOpCopy</code></a><ul>
<li class="chapter" data-level="6.2.1.1" data-path="extending-pipeops.html"><a href="extending-pipeops.html#first-steps-inheriting-from-pipeop"><i class="fa fa-check"></i><b>6.2.1.1</b> First Steps: Inheriting from <code>PipeOp</code></a></li>
<li class="chapter" data-level="6.2.1.2" data-path="extending-pipeops.html"><a href="extending-pipeops.html#channel-definitions"><i class="fa fa-check"></i><b>6.2.1.2</b> Channel Definitions</a></li>
<li class="chapter" data-level="6.2.1.3" data-path="extending-pipeops.html"><a href="extending-pipeops.html#train-and-predict"><i class="fa fa-check"></i><b>6.2.1.3</b> Train and Predict</a></li>
<li class="chapter" data-level="6.2.1.4" data-path="extending-pipeops.html"><a href="extending-pipeops.html#putting-it-together"><i class="fa fa-check"></i><b>6.2.1.4</b> Putting it Together</a></li>
</ul></li>
<li class="chapter" data-level="6.2.2" data-path="extending-pipeops.html"><a href="extending-pipeops.html#ext-pipe-preproc"><i class="fa fa-check"></i><b>6.2.2</b> Special Case: Preprocessing</a><ul>
<li class="chapter" data-level="6.2.2.1" data-path="extending-pipeops.html"><a href="extending-pipeops.html#example-pipeopdropna"><i class="fa fa-check"></i><b>6.2.2.1</b> Example: <code>PipeOpDropNA</code></a></li>
<li class="chapter" data-level="6.2.2.2" data-path="extending-pipeops.html"><a href="extending-pipeops.html#example-pipeopscalealways"><i class="fa fa-check"></i><b>6.2.2.2</b> Example: <code>PipeOpScaleAlways</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2.3" data-path="extending-pipeops.html"><a href="extending-pipeops.html#special-case-preprocessing-with-simple-train"><i class="fa fa-check"></i><b>6.2.3</b> Special Case: Preprocessing with Simple Train</a><ul>
<li class="chapter" data-level="6.2.3.1" data-path="extending-pipeops.html"><a href="extending-pipeops.html#example-pipeopdropconst"><i class="fa fa-check"></i><b>6.2.3.1</b> Example: <code>PipeOpDropConst</code></a></li>
<li class="chapter" data-level="6.2.3.2" data-path="extending-pipeops.html"><a href="extending-pipeops.html#example-pipeopscalealwayssimple"><i class="fa fa-check"></i><b>6.2.3.2</b> Example: <code>PipeOpScaleAlwaysSimple</code></a></li>
</ul></li>
<li class="chapter" data-level="6.2.4" data-path="extending-pipeops.html"><a href="extending-pipeops.html#ext-pipe-hyperpars"><i class="fa fa-check"></i><b>6.2.4</b> Hyperparameters</a><ul>
<li class="chapter" data-level="6.2.4.1" data-path="extending-pipeops.html"><a href="extending-pipeops.html#hyperparameter-example-pipeopscale"><i class="fa fa-check"></i><b>6.2.4.1</b> Hyperparameter Example: <code>PipeOpScale</code></a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="special-tasks.html"><a href="special-tasks.html"><i class="fa fa-check"></i><b>7</b> Special Tasks</a><ul>
<li class="chapter" data-level="7.1" data-path="survival.html"><a href="survival.html"><i class="fa fa-check"></i><b>7.1</b> Survival Analysis</a></li>
<li class="chapter" data-level="7.2" data-path="spatial.html"><a href="spatial.html"><i class="fa fa-check"></i><b>7.2</b> Spatial Analysis</a></li>
<li class="chapter" data-level="7.3" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i><b>7.3</b> Ordinal Analysis</a></li>
<li class="chapter" data-level="7.4" data-path="functional.html"><a href="functional.html"><i class="fa fa-check"></i><b>7.4</b> Functional Analysis</a><ul>
<li class="chapter" data-level="7.4.1" data-path="functional.html"><a href="functional.html#how-to-model-functional-data"><i class="fa fa-check"></i><b>7.4.1</b> How to model functional data?</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="multilabel.html"><a href="multilabel.html"><i class="fa fa-check"></i><b>7.5</b> Multilabel Classification</a></li>
<li class="chapter" data-level="7.6" data-path="cost-sens.html"><a href="cost-sens.html"><i class="fa fa-check"></i><b>7.6</b> Cost-Sensitive Classification</a><ul>
<li class="chapter" data-level="7.6.1" data-path="cost-sens.html"><a href="cost-sens.html#a-first-model"><i class="fa fa-check"></i><b>7.6.1</b> A First Model</a></li>
<li class="chapter" data-level="7.6.2" data-path="cost-sens.html"><a href="cost-sens.html#cost-sensitive-measure"><i class="fa fa-check"></i><b>7.6.2</b> Cost-sensitive Measure</a></li>
<li class="chapter" data-level="7.6.3" data-path="cost-sens.html"><a href="cost-sens.html#thresholding"><i class="fa fa-check"></i><b>7.6.3</b> Thresholding</a></li>
<li class="chapter" data-level="7.6.4" data-path="cost-sens.html"><a href="cost-sens.html#threshold-tuning-1"><i class="fa fa-check"></i><b>7.6.4</b> Threshold Tuning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="interpretation.html"><a href="interpretation.html"><i class="fa fa-check"></i><b>8</b> Model Interpretation</a><ul>
<li class="chapter" data-level="8.1" data-path="iml.html"><a href="iml.html"><i class="fa fa-check"></i><b>8.1</b> IML</a></li>
<li class="chapter" data-level="8.2" data-path="dalex.html"><a href="dalex.html"><i class="fa fa-check"></i><b>8.2</b> Dalex</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>9</b> Appendix</a><ul>
<li class="chapter" data-level="9.1" data-path="list-learners.html"><a href="list-learners.html"><i class="fa fa-check"></i><b>9.1</b> Integrated Learners</a></li>
<li class="chapter" data-level="9.2" data-path="list-measures.html"><a href="list-measures.html"><i class="fa fa-check"></i><b>9.2</b> Integrated Performance Measures</a></li>
<li class="chapter" data-level="9.3" data-path="list-filters.html"><a href="list-filters.html"><i class="fa fa-check"></i><b>9.3</b> Integrated Filter Methods</a><ul>
<li class="chapter" data-level="9.3.1" data-path="list-filters.html"><a href="list-filters.html#fs-filter-list"><i class="fa fa-check"></i><b>9.3.1</b> Standalone filter methods</a></li>
<li class="chapter" data-level="9.3.2" data-path="list-filters.html"><a href="list-filters.html#fs-filter-embedded-list"><i class="fa fa-check"></i><b>9.3.2</b> Algorithms With Embedded Filter Methods</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="list-pipeops.html"><a href="list-pipeops.html"><i class="fa fa-check"></i><b>9.4</b> Integrated PipeOp’s</a></li>
<li class="chapter" data-level="9.5" data-path="compare-frameworks.html"><a href="compare-frameworks.html"><i class="fa fa-check"></i><b>9.5</b> Framework Comparison</a><ul>
<li class="chapter" data-level="9.5.1" data-path="compare-frameworks.html"><a href="compare-frameworks.html#an-introduction-to-pipeops"><i class="fa fa-check"></i><b>9.5.1</b> An introduction to “PipeOp”s</a><ul>
<li class="chapter" data-level="9.5.1.1" data-path="compare-frameworks.html"><a href="compare-frameworks.html#a-quick-glance-into-a-pipeop"><i class="fa fa-check"></i><b>9.5.1.1</b> A quick glance into a PipeOp</a></li>
<li class="chapter" data-level="9.5.1.2" data-path="compare-frameworks.html"><a href="compare-frameworks.html#constructing-the-pipeline"><i class="fa fa-check"></i><b>9.5.1.2</b> Constructing the Pipeline</a></li>
</ul></li>
<li class="chapter" data-level="9.5.2" data-path="compare-frameworks.html"><a href="compare-frameworks.html#mlr3pipelines-vs.mlr"><i class="fa fa-check"></i><b>9.5.2</b> mlr3pipelines vs. mlr</a><ul>
<li class="chapter" data-level="9.5.2.1" data-path="compare-frameworks.html"><a href="compare-frameworks.html#mlr"><i class="fa fa-check"></i><b>9.5.2.1</b> mlr</a></li>
<li class="chapter" data-level="9.5.2.2" data-path="compare-frameworks.html"><a href="compare-frameworks.html#mlr3pipelines"><i class="fa fa-check"></i><b>9.5.2.2</b> mlr3pipelines</a></li>
</ul></li>
<li class="chapter" data-level="9.5.3" data-path="compare-frameworks.html"><a href="compare-frameworks.html#mlr3pipelines-vs.sklearn.pipeline.pipeline"><i class="fa fa-check"></i><b>9.5.3</b> mlr3pipelines vs. sklearn.pipeline.Pipeline</a><ul>
<li class="chapter" data-level="9.5.3.1" data-path="compare-frameworks.html"><a href="compare-frameworks.html#sklearn"><i class="fa fa-check"></i><b>9.5.3.1</b> sklearn</a></li>
<li class="chapter" data-level="9.5.3.2" data-path="compare-frameworks.html"><a href="compare-frameworks.html#mlr3pipelines-1"><i class="fa fa-check"></i><b>9.5.3.2</b> mlr3pipelines</a></li>
</ul></li>
<li class="chapter" data-level="9.5.4" data-path="compare-frameworks.html"><a href="compare-frameworks.html#mlr3pipelines-vs-recipes"><i class="fa fa-check"></i><b>9.5.4</b> mlr3pipelines vs recipes</a><ul>
<li class="chapter" data-level="9.5.4.1" data-path="compare-frameworks.html"><a href="compare-frameworks.html#recipes"><i class="fa fa-check"></i><b>9.5.4.1</b> recipes</a></li>
<li class="chapter" data-level="9.5.4.2" data-path="compare-frameworks.html"><a href="compare-frameworks.html#mlr3pipelines-2"><i class="fa fa-check"></i><b>9.5.4.2</b> mlr3pipelines</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="./">Made with <i class="fas fa-heart"></i> for open-source </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advanced-an-in-depth-look-into-mlr3pipelines" class="section level2">
<h2><span class="header-section-number">4.7</span> Advanced: An in-depth look into mlr3pipelines</h2>
<p>This vignette is an in-depth introduction to <a href="https://cran.r-project.org/package=mlr3pipelines">mlr3pipelines</a>, the dataflow programming toolkit for machine learning in <code>R</code> using <a href="https://mlr3.mlr-org.com">mlr3</a>.
It will go through basic concepts and then give a few examples that both show the simplicity as well as the power and versatility of using <a href="https://cran.r-project.org/package=mlr3pipelines">mlr3pipelines</a>.</p>
<div id="whats-the-point" class="section level3">
<h3><span class="header-section-number">4.7.1</span> What’s the Point</h3>
<p>Machine learning toolkits often try to abstract away the processes happening inside machine learning algorithms.
This makes it easy for the user to switch out one algorithm for another without having to worry about what is happening inside it, what kind of data it is able to operate on etc.
The benefit of using <code>mlr3</code>, for example, is that one can create a <code>Learner</code>, a <code>Task</code>, a <code>Resampling</code> etc. and use them for typical machine learning operations.
It is trivial to exchange individual components and therefore use, for example, a different <code>Learner</code> in the same experiment for comparison.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" data-line-number="1">task =<span class="st"> </span>TaskClassif<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;iris&quot;</span>, <span class="kw">as_data_backend</span>(iris), <span class="st">&quot;Species&quot;</span>)</a>
<a class="sourceLine" id="cb277-2" data-line-number="2">lrn =<span class="st"> </span>mlr_learners<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;classif.rpart&quot;</span>)</a>
<a class="sourceLine" id="cb277-3" data-line-number="3">rsmp =<span class="st"> </span>mlr_resamplings<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;holdout&quot;</span>)</a>
<a class="sourceLine" id="cb277-4" data-line-number="4"><span class="kw">resample</span>(task, lrn, rsmp)</a></code></pre></div>
<pre><code>## &lt;ResampleResult&gt; of 1 iterations
## * Task: iris
## * Learner: classif.rpart
## * Warnings: 0 in 0 iterations
## * Errors: 0 in 0 iterations</code></pre>
<p>However, this modularity breaks down as soon as the learning algorithm encompasses more than just model fitting, like data preprocessing, ensembles or other meta models.
<a href="https://cran.r-project.org/package=mlr3pipelines">mlr3pipelines</a> takes modularity one step further than <code>mlr3</code>: it makes it possible to build individual steps within a <code>Learner</code> out of building blocks called <strong><code>PipeOp</code>s</strong>.</p>
</div>
<div id="pipeop-pipeline-operators" class="section level3">
<h3><span class="header-section-number">4.7.2</span> <code>PipeOp</code>: Pipeline Operators</h3>
<p>The most basic unit of functionality within <a href="https://cran.r-project.org/package=mlr3pipelines">mlr3pipelines</a> is the <strong><code>PipeOp</code></strong>, short for “pipeline operator”, which represents a trans-formative operation on input (for example a training dataset) leading to output.
It can therefore be seen as a generalized notion of a function, with a certain twist: <code>PipeOp</code>s behave differently during a “training phase” and a “prediction phase”.
The training phase will typically generate a certain model of the data that is saved as internal state.
The prediction phase will then operate on the input data depending on the trained model.</p>
<p>An example of this behavior is the <em>principal component analysis</em> operation (“<code>PipeOpPCA</code>”):
During training, it will transform incoming data by rotating it in a way that leads to uncorrelated features ordered by their contribution to total variance.
It will <em>also</em> save the rotation matrix to be used during for new data.
This makes it possible to perform “prediction” with single rows of new data, where a row’s scores on each of the principal components (the components of the training data!) is computed.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" data-line-number="1">po =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;pca&quot;</span>)</a>
<a class="sourceLine" id="cb279-2" data-line-number="2">po<span class="op">$</span><span class="kw">train</span>(<span class="kw">list</span>(task))[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">data</span>()</a></code></pre></div>
<pre><code>## # A tibble: 150 x 5
##    Species   PC1     PC2     PC3      PC4
##    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1 setosa  -2.68  0.319  -0.0279 -0.00226
##  2 setosa  -2.71 -0.177  -0.210  -0.0990 
##  3 setosa  -2.89 -0.145   0.0179 -0.0200 
##  4 setosa  -2.75 -0.318   0.0316  0.0756 
##  5 setosa  -2.73  0.327   0.0901  0.0613 
##  6 setosa  -2.28  0.741   0.169   0.0242 
##  7 setosa  -2.82 -0.0895  0.258   0.0481 
##  8 setosa  -2.63  0.163  -0.0219  0.0453 
##  9 setosa  -2.89 -0.578   0.0208  0.0267 
## 10 setosa  -2.67 -0.114  -0.198   0.0563 
## # … with 140 more rows</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" data-line-number="1">single_line_task =<span class="st"> </span>task<span class="op">$</span><span class="kw">clone</span>()<span class="op">$</span><span class="kw">filter</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb281-2" data-line-number="2">po<span class="op">$</span><span class="kw">predict</span>(<span class="kw">list</span>(single_line_task))[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">data</span>()</a></code></pre></div>
<pre><code>## # A tibble: 1 x 5
##   Species   PC1   PC2     PC3      PC4
##   &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1 setosa  -2.68 0.319 -0.0279 -0.00226</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" data-line-number="1">po<span class="op">$</span>state</a></code></pre></div>
<pre><code>## Standard deviations (1, .., p=4):
## [1] 2.0563 0.4926 0.2797 0.1544
## 
## Rotation (n x k) = (4 x 4):
##                   PC1      PC2      PC3     PC4
## Petal.Length  0.85667 -0.17337  0.07624  0.4798
## Petal.Width   0.35829 -0.07548  0.54583 -0.7537
## Sepal.Length  0.36139  0.65659 -0.58203 -0.3155
## Sepal.Width  -0.08452  0.73016  0.59791  0.3197</code></pre>
<p>This shows the most important primitives incorporated in a <code>PipeOp</code>:
* <strong><code>$train()</code></strong>, taking a list of input arguments, turning them into a list of outputs, meanwhile saving a state in <code>$state</code>
* <strong><code>$predict()</code></strong>, taking a list of input arguments, turning them into a list of outputs, making use of the saved <code>$state</code>
* <strong><code>$state</code></strong>, the “model” trained with <code>$train()</code> and utilized during <code>$predict()</code>.</p>
<p>Schematically we can represent the <code>PipeOp</code> like so:</p>
<p><img src="images/po_viz.png" style="display: block; margin: auto;" /></p>
<div id="why-the-state" class="section level4">
<h4><span class="header-section-number">4.7.2.1</span> Why the <code>$state</code></h4>
<p>It is important to take a moment and notice the importance of a <code>$state</code> variable and the <code>$train()</code> / <code>$predict()</code> dichotomy in a <code>PipeOp</code>.
There are many preprocessing methods, for example scaling of parameters or imputation, that could in theory just be applied to training data and prediction / validation data separately, or they could be applied to a task before resampling is performed.
This would, however, be fallacious:</p>
<ul>
<li>The preprocessing of each instance of prediction data should not depend on the remaining prediction dataset.
A prediction on a single instance of new data should give the same result as prediction performed on a whole dataset.</li>
<li>If preprocessing is performed on a task <em>before</em> resampling is done, information about the test set can leak into the training set.
Resampling should evaluate the generalization performance of the <em>entire</em> machine learning method, therefore the behavior of this entire method must only depend only on the content of the <em>training</em> split during resampling.</li>
</ul>
</div>
<div id="where-to-get-pipeops" class="section level4">
<h4><span class="header-section-number">4.7.2.2</span> Where to Get <code>PipeOp</code>s</h4>
<p>Each <code>PipeOp</code> is an instance of an “<code>R6</code>” class, many of which are provided by the <a href="https://cran.r-project.org/package=mlr3pipelines">mlr3pipelines</a> package itself.
They can be constructed explicitly (“<code>PipeOpPCA$new()</code>”) or retrieved from the <code>mlr_pipelines</code> collection: <code>mlr_pipeops$get(&quot;pca&quot;)</code>.
The entire list of available <code>PipeOp</code>s, and some meta-information, can be retrieved using <code>as.data.table()</code>:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" data-line-number="1"><span class="kw">as.data.table</span>(mlr_pipeops)[, <span class="kw">c</span>(<span class="st">&quot;key&quot;</span>, <span class="st">&quot;input.num&quot;</span>, <span class="st">&quot;output.num&quot;</span>)]</a></code></pre></div>
<pre><code>## # A tibble: 42 x 3
##    key             input.num output.num
##    &lt;chr&gt;               &lt;int&gt;      &lt;int&gt;
##  1 boxcox                  1          1
##  2 branch                  1         NA
##  3 chunk                   1         NA
##  4 classbalancing          1          1
##  5 classifavg             NA          1
##  6 classweights            1          1
##  7 colapply                1          1
##  8 collapsefactors         1          1
##  9 copy                    1         NA
## 10 encode                  1          1
## # … with 32 more rows</code></pre>
<p>When retrieving <code>PipeOp</code>s from the <code>mlr_pipeops</code> dictionary, it is also possible to give additional constructor arguments, such as an <a href="advanced-an-in-depth-look-into-mlr3pipelines.html#pipeop-ids-and-id-name-clashes">id</a> or <a href="advanced-an-in-depth-look-into-mlr3pipelines.html#hyperparameters">parameter values</a>.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" data-line-number="1">mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;pca&quot;</span>, <span class="dt">param_vals =</span> <span class="kw">list</span>(<span class="dt">rank. =</span> <span class="dv">3</span>))</a></code></pre></div>
<pre><code>## PipeOp: &lt;pca&gt; (not trained)
## values: &lt;rank.=3&gt;
## Input channels &lt;name [train type, predict type]&gt;:
##   input [Task,Task]
## Output channels &lt;name [train type, predict type]&gt;:
##   output [Task,Task]</code></pre>
</div>
</div>
<div id="pipeop-channels" class="section level3">
<h3><span class="header-section-number">4.7.3</span> PipeOp Channels</h3>
<div id="input-channels" class="section level4">
<h4><span class="header-section-number">4.7.3.1</span> Input Channels</h4>
<p>Just like functions, <code>PipeOp</code>s can take multiple inputs.
These multiple inputs are always given as elements in the input list.
For example, there is a <code>PipeOpFeatureUnion</code> that combines multiple tasks with different features and “<code>cbind()</code>s” them together, creating one combined task.
When two halves of the <code>iris</code> task are given, for example, it recreates the original task:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" data-line-number="1">iris_first_half =<span class="st"> </span>task<span class="op">$</span><span class="kw">clone</span>()<span class="op">$</span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;Petal.Length&quot;</span>, <span class="st">&quot;Petal.Width&quot;</span>))</a>
<a class="sourceLine" id="cb289-2" data-line-number="2">iris_second_half =<span class="st"> </span>task<span class="op">$</span><span class="kw">clone</span>()<span class="op">$</span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>, <span class="st">&quot;Sepal.Width&quot;</span>))</a>
<a class="sourceLine" id="cb289-3" data-line-number="3"></a>
<a class="sourceLine" id="cb289-4" data-line-number="4">pofu =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;featureunion&quot;</span>, <span class="dt">innum =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb289-5" data-line-number="5"></a>
<a class="sourceLine" id="cb289-6" data-line-number="6">pofu<span class="op">$</span><span class="kw">train</span>(<span class="kw">list</span>(iris_first_half, iris_second_half))[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">data</span>()</a></code></pre></div>
<pre><code>## # A tibble: 150 x 5
##    Species Petal.Length Petal.Width Sepal.Length Sepal.Width
##    &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
##  1 setosa           1.4         0.2          5.1         3.5
##  2 setosa           1.4         0.2          4.9         3  
##  3 setosa           1.3         0.2          4.7         3.2
##  4 setosa           1.5         0.2          4.6         3.1
##  5 setosa           1.4         0.2          5           3.6
##  6 setosa           1.7         0.4          5.4         3.9
##  7 setosa           1.4         0.3          4.6         3.4
##  8 setosa           1.5         0.2          5           3.4
##  9 setosa           1.4         0.2          4.4         2.9
## 10 setosa           1.5         0.1          4.9         3.1
## # … with 140 more rows</code></pre>
<p>Because <code>PipeOpFeatureUnion</code> effectively takes two input arguments here, we can say it has two <strong>input channels</strong>.
An input channel also carries information about the <em>type</em> of input that is acceptable.
The input channels of the <code>pofu</code> object constructed above, for example, each accept a <code>Task</code> during training and prediction.
This information can be queried from the <code>$input</code> slot:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" data-line-number="1">pofu<span class="op">$</span>input</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   name   train predict
##   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  
## 1 input1 Task  Task   
## 2 input2 Task  Task</code></pre>
<p>Other <code>PipeOp</code>s may have channels that take different types during different phases.
The <code>backuplearner</code> <code>PipeOp</code>, for example, takes a <code>NULL</code> and a <code>Task</code> during training, and a <code>Prediction</code> and a <code>Task</code> during prediction:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" data-line-number="1">## <span class="al">TODO</span> this is an important case to handle here, do not delete unless there is a better example.</a>
<a class="sourceLine" id="cb293-2" data-line-number="2">## mlr_pipeops$get(&quot;backuplearner&quot;)$input</a></code></pre></div>
</div>
<div id="output-channels" class="section level4">
<h4><span class="header-section-number">4.7.3.2</span> Output Channels</h4>
<p>Unlike the typical notion of a function, <code>PipeOp</code>s can also have multiple <strong>output channels</strong>.
<code>$train()</code> and <code>$predict()</code> always return a list, so certain <code>PipeOp</code>s may return lists with more than one element.
Similar to input channels, the information about the number and type of outputs given by a <code>PipeOp</code> is available in the <code>$output</code> slot.
The <code>chunk</code> PipeOp, for example, chunks a given <code>Task</code> into subsets and consequently returns multiple <code>Task</code> objects, both during training and prediction.
The number of output channels must be given during construction through the <code>outnum</code> argument.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" data-line-number="1">mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;chunk&quot;</span>, <span class="dt">outnum =</span> <span class="dv">3</span>)<span class="op">$</span>output</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   name    train predict
##   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  
## 1 output1 Task  Task   
## 2 output2 Task  Task   
## 3 output3 Task  Task</code></pre>
<p>Note that the number of output channels during training and prediction is the same.
A schema of a <code>PipeOp</code> with two output channels:</p>
<p><img src="images/po_multi_alone.png" style="display: block; margin: auto;" /></p>
</div>
<div id="channel-configuration" class="section level4">
<h4><span class="header-section-number">4.7.3.3</span> Channel Configuration</h4>
<p>Most <code>PipeOp</code>s have only one input channel (so they take a list with a single element), but there are a few with more than one;
In many cases, the number of input or output channels is determined during construction, e.g. through the <code>innum</code> / <code>outnum</code> arguments.
The <code>input.num</code> and <code>output.num</code> columns of the <code>mlr_pipeops</code>-table <a href="advanced-an-in-depth-look-into-mlr3pipelines.html#where-to-get-pipeops">above</a> show the default number of channels, and <code>NA</code> if the number depends on a construction argument.</p>
<p>The default printer of a <code>PipeOp</code> gives information about channel names and types:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" data-line-number="1">## mlr_pipeops$get(&quot;backuplearner&quot;)</a></code></pre></div>
</div>
</div>
<div id="graph-networks-of-pipeops" class="section level3">
<h3><span class="header-section-number">4.7.4</span> <code>Graph</code>: Networks of <code>PipeOp</code>s</h3>
<div id="basics-1" class="section level4">
<h4><span class="header-section-number">4.7.4.1</span> Basics</h4>
<p>What is the advantage of this tedious way of declaring input and output channels and handling in/output through lists?
Because each <code>PipeOp</code> has a known number of input and output channels that always produce or accept data of a known type, it is possible to network them together in <strong><code>Graph</code></strong>s.
A <code>Graph</code> is a collection of <code>PipeOp</code>s with “edges” that mandate that data should be flowing along them.
Edges always pass between <code>PipeOp</code> <em>channels</em>, so it is not only possible to explicitly prescribe which position of an input or output list an edge refers to, it makes it possible to make different components of a <code>PipeOp</code>’s output flow to multiple different other <code>PipeOp</code>s, as well as to have a <code>PipeOp</code> gather its input from multiple other <code>PipeOp</code>s.</p>
<p>A schema of a simple graph of <code>PipeOp</code>s:
<img src="images/po_multi_viz.png" style="display: block; margin: auto;" /></p>
<p>A <code>Graph</code> is empty when first created, and <code>PipeOp</code>s can be added using the <strong><code>$add_pipeop()</code></strong> method.
The <strong><code>$add_edge()</code></strong> method is used to create connections between them.
While the printer of a <code>Graph</code> gives some information about its layout, the most intuitive way of visualizing it is using the <code>$plot()</code> function.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" data-line-number="1">gr =<span class="st"> </span>Graph<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb297-2" data-line-number="2">gr<span class="op">$</span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;scale&quot;</span>))</a>
<a class="sourceLine" id="cb297-3" data-line-number="3">gr<span class="op">$</span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;subsample&quot;</span>, <span class="dt">param_vals =</span> <span class="kw">list</span>(<span class="dt">frac =</span> <span class="fl">0.1</span>)))</a>
<a class="sourceLine" id="cb297-4" data-line-number="4">gr<span class="op">$</span><span class="kw">add_edge</span>(<span class="st">&quot;scale&quot;</span>, <span class="st">&quot;subsample&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" data-line-number="1"><span class="kw">print</span>(gr)</a></code></pre></div>
<pre><code>## Graph with 2 PipeOps:
##         ID         State  sccssors prdcssors
##      scale &lt;&lt;UNTRAINED&gt;&gt; subsample          
##  subsample &lt;&lt;UNTRAINED&gt;&gt;               scale</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" data-line-number="1">gr<span class="op">$</span><span class="kw">plot</span>(<span class="dt">html =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div id="htmlwidget-2b907e142a509c528f26" style="width:50%;height:400px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-2b907e142a509c528f26">{"x":{"nodes":{"id":["scale","<INPUT>","subsample","<OUTPUT>"],"label":["scale","<INPUT>","subsample","<OUTPUT>"],"shape":["box","database","box","ellipse"],"color":["lightblue","rgba(0,204,102,0.2)","lightblue","rgba(255,51,51,0.2)"],"value":[1,0.8,1,0.8],"title":["<p>PipeOp: <b>scale<\/b> (not trained)<br>values: <b>list()<\/b><br>Input channels <b>name [train type, predict type]<\/b>:<br>  input [Task,Task]<br>Output channels <b>name [train type, predict type]<\/b>:<br>  output [Task,Task]<\/p>","<p>Input:<br>Name: scale.input<br>Train: Task<br>Predict: Task<\/p>","<p>PipeOp: <b>subsample<\/b> (not trained)<br>values: <b>frac=0.1, stratify=FALSE, replace=FALSE<\/b><br>Input channels <b>name [train type, predict type]<\/b>:<br>  input [Task,Task]<br>Output channels <b>name [train type, predict type]<\/b>:<br>  output [Task,Task]<\/p>","<p>Output:<br>Name: subsample.output<br>Train: Task<br>Predict: Task<\/p>"],"x":[0,0,0,0],"y":[-0.333333333333333,-1,0.333333333333333,1]},"edges":{"from":["scale","<INPUT>","subsample"],"to":["subsample","scale","<OUTPUT>"],"color":["lightblue","lightblue","lightblue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"to","smooth":{"enabled":false,"forceDirection":"vertical"}},"physics":{"stabilization":false}},"groups":null,"width":"50%","height":"400px","idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"full"}},"evals":[],"jsHooks":[]}</script>
<p>A <code>Graph</code> itself has a <strong><code>$train()</code></strong> and a <strong><code>$predict()</code></strong> method that accept some data and propagate this data through the network of <code>PipeOp</code>s.
The return value corresponds to the output of the <code>PipeOp</code> output channels that are not connected to other <code>PipeOp</code>s.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" data-line-number="1">gr<span class="op">$</span><span class="kw">train</span>(task)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">data</span>()</a></code></pre></div>
<pre><code>## # A tibble: 15 x 5
##    Species    Petal.Length Petal.Width Sepal.Length Sepal.Width
##    &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
##  1 setosa           -1.17    -1.31          -0.535        0.786
##  2 setosa           -1.45    -1.31          -1.02         0.327
##  3 setosa           -1.28    -1.31          -0.656        1.47 
##  4 versicolor        0.137    0.132          0.310       -0.590
##  5 versicolor        0.307    0.132          0.672       -0.361
##  6 versicolor       -0.146   -0.262         -0.173       -1.05 
##  7 versicolor        0.137    0.000875      -0.0523      -1.05 
##  8 virginica         1.44     0.788          1.76        -0.361
##  9 virginica         0.987    1.18           1.16        -0.132
## 10 virginica         0.647    0.788          0.551       -0.820
## 11 virginica         1.50     1.05           2.48         1.70 
## 12 virginica         0.760    0.394          0.551       -0.590
## 13 virginica         1.33     1.44           2.24        -0.132
## 14 virginica         0.817    1.05           0.793       -0.132
## 15 virginica         0.760    0.788          0.0684      -0.132</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" data-line-number="1">gr<span class="op">$</span><span class="kw">predict</span>(single_line_task)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">data</span>()</a></code></pre></div>
<pre><code>## # A tibble: 1 x 5
##   Species Petal.Length Petal.Width Sepal.Length Sepal.Width
##   &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 setosa         -1.34       -1.31       -0.898        1.02</code></pre>
<p>The collection of <code>PipeOp</code>s inside a <code>Graph</code> can be accessed through the <strong><code>$pipeops</code></strong> slot.
The set of edges in the Graph can be inspected through the <strong><code>$edges</code></strong> slot.
It is possible to modify individual <code>PipeOps</code> and edges in a Graph through these slots, but this is not recommended because no error checking is performed and it may put the <code>Graph</code> in an unsupported state.</p>
</div>
<div id="networks" class="section level4">
<h4><span class="header-section-number">4.7.4.2</span> Networks</h4>
<p>The example above showed a linear preprocessing pipeline, but it is in fact possible to build true “graphs” of operations, as long as no loops are introduced<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.
<code>PipeOp</code>s with multiple output channels can feed their data to multiple different subsequent <code>PipeOp</code>s, and <code>PipeOp</code>s with multiple input channels can take results from different <code>PipeOp</code>s.
When a <code>PipeOp</code> has more than one input / output channel, then the <code>Graph</code>’s <code>$add_edge()</code> method needs an additional argument that indicates which channel to connect to.
This argument can be given in the form of an integer, or as the name of the channel.</p>
<p>The following constructs a <code>Graph</code> that copies the input and gives one copy each to a “scale” and a “pca” <code>PipeOp</code>.
The resulting columns of each operation are put next to each other by “featureunion”.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" data-line-number="1">gr =<span class="st"> </span>Graph<span class="op">$</span><span class="kw">new</span>()<span class="op">$</span></a>
<a class="sourceLine" id="cb305-2" data-line-number="2"><span class="st">  </span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;copy&quot;</span>, <span class="dt">outnum =</span> <span class="dv">2</span>))<span class="op">$</span></a>
<a class="sourceLine" id="cb305-3" data-line-number="3"><span class="st">  </span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;scale&quot;</span>))<span class="op">$</span></a>
<a class="sourceLine" id="cb305-4" data-line-number="4"><span class="st">  </span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;pca&quot;</span>))<span class="op">$</span></a>
<a class="sourceLine" id="cb305-5" data-line-number="5"><span class="st">  </span><span class="kw">add_pipeop</span>(mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;featureunion&quot;</span>, <span class="dt">innum =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb305-6" data-line-number="6"></a>
<a class="sourceLine" id="cb305-7" data-line-number="7">gr<span class="op">$</span></a>
<a class="sourceLine" id="cb305-8" data-line-number="8"><span class="st">  </span><span class="kw">add_edge</span>(<span class="st">&quot;copy&quot;</span>, <span class="st">&quot;scale&quot;</span>, <span class="dt">src_channel =</span> <span class="dv">1</span>)<span class="op">$</span><span class="st">        </span>## designating channel by index</a>
<a class="sourceLine" id="cb305-9" data-line-number="9"><span class="st">  </span><span class="kw">add_edge</span>(<span class="st">&quot;copy&quot;</span>, <span class="st">&quot;pca&quot;</span>, <span class="dt">src_channel =</span> <span class="st">&quot;output2&quot;</span>)<span class="op">$</span><span class="st">  </span>## designating channel by name</a>
<a class="sourceLine" id="cb305-10" data-line-number="10"><span class="st">  </span><span class="kw">add_edge</span>(<span class="st">&quot;scale&quot;</span>, <span class="st">&quot;featureunion&quot;</span>, <span class="dt">dst_channel =</span> <span class="dv">1</span>)<span class="op">$</span></a>
<a class="sourceLine" id="cb305-11" data-line-number="11"><span class="st">  </span><span class="kw">add_edge</span>(<span class="st">&quot;pca&quot;</span>, <span class="st">&quot;featureunion&quot;</span>, <span class="dt">dst_channel =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb305-12" data-line-number="12"></a>
<a class="sourceLine" id="cb305-13" data-line-number="13">gr<span class="op">$</span><span class="kw">plot</span>(<span class="dt">html =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div id="htmlwidget-314893217ad4c344ae12" style="width:50%;height:400px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-314893217ad4c344ae12">{"x":{"nodes":{"id":["copy","scale","pca","<INPUT>","featureunion","<OUTPUT>"],"label":["copy","scale","pca","<INPUT>","featureunion","<OUTPUT>"],"shape":["box","box","box","database","box","ellipse"],"color":["lightblue","lightblue","lightblue","rgba(0,204,102,0.2)","lightblue","rgba(255,51,51,0.2)"],"value":[1,1,1,0.8,1,0.8],"title":["<p>PipeOp: <b>copy<\/b> (not trained)<br>values: <b>list()<\/b><br>Input channels <b>name [train type, predict type]<\/b>:<br>  input [*,*]<br>Output channels <b>name [train type, predict type]<\/b>:<br>  output1 [*,*], output2 [*,*]<\/p>","<p>PipeOp: <b>scale<\/b> (not trained)<br>values: <b>list()<\/b><br>Input channels <b>name [train type, predict type]<\/b>:<br>  input [Task,Task]<br>Output channels <b>name [train type, predict type]<\/b>:<br>  output [Task,Task]<\/p>","<p>PipeOp: <b>pca<\/b> (not trained)<br>values: <b>list()<\/b><br>Input channels <b>name [train type, predict type]<\/b>:<br>  input [Task,Task]<br>Output channels <b>name [train type, predict type]<\/b>:<br>  output [Task,Task]<\/p>","<p>Input:<br>Name: copy.input<br>Train: *<br>Predict: *<\/p>","<p>PipeOp: <b>featureunion<\/b> (not trained)<br>values: <b>list()<\/b><br>Input channels <b>name [train type, predict type]<\/b>:<br>  input1 [Task,Task], input2 [Task,Task]<br>Output channels <b>name [train type, predict type]<\/b>:<br>  output [Task,Task]<\/p>","<p>Output:<br>Name: featureunion.output<br>Train: Task<br>Predict: Task<\/p>"],"x":[0,-1,1,0,0,0],"y":[-0.5,0,0,-1,0.5,1]},"edges":{"from":["copy","copy","scale","pca","<INPUT>","featureunion"],"to":["scale","pca","featureunion","featureunion","copy","<OUTPUT>"],"color":["lightblue","lightblue","lightblue","lightblue","lightblue","lightblue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"to","smooth":{"enabled":false,"forceDirection":"vertical"}},"physics":{"stabilization":false}},"groups":null,"width":"50%","height":"400px","idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"full"}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" data-line-number="1">gr<span class="op">$</span><span class="kw">train</span>(iris_first_half)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">data</span>()</a></code></pre></div>
<pre><code>## # A tibble: 150 x 5
##    Species Petal.Length Petal.Width   PC1      PC2
##    &lt;fct&gt;          &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 setosa         -1.34       -1.31 -2.56 -0.00692
##  2 setosa         -1.34       -1.31 -2.56 -0.00692
##  3 setosa         -1.39       -1.31 -2.65  0.0318 
##  4 setosa         -1.28       -1.31 -2.47 -0.0457 
##  5 setosa         -1.34       -1.31 -2.56 -0.00692
##  6 setosa         -1.17       -1.05 -2.21  0.0611 
##  7 setosa         -1.34       -1.18 -2.52  0.0853 
##  8 setosa         -1.28       -1.31 -2.47 -0.0457 
##  9 setosa         -1.34       -1.31 -2.56 -0.00692
## 10 setosa         -1.28       -1.44 -2.51 -0.138  
## # … with 140 more rows</code></pre>
</div>
<div id="syntactic-sugar" class="section level4">
<h4><span class="header-section-number">4.7.4.3</span> Syntactic Sugar</h4>
<p>Although it is possible to create intricate <code>Graphs</code> with edges going all over the place (as long as no loops are introduced), there is usually a clear direction of flow between “layers” in the <code>Graph</code>.
It is therefore convenient to build up a <code>Graph</code> from layers, which can be done using the <strong><code>%&gt;&gt;%</code></strong> (“double-arrow”) operator.
It takes either a <code>PipeOp</code> or a <code>Graph</code> on each of its sides and connects all of the outputs of its left-hand side to one of the inputs each of its right-hand side–the number of inputs therefore must match the number of outputs.
Together with the <strong><code>gunion()</code></strong> operation, which takes <code>PipeOp</code>s or <code>Graph</code>s and arranges them next to each other akin to a (disjoint) graph union, the above network can more easily be constructed as follows:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" data-line-number="1">gr =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;copy&quot;</span>, <span class="dt">outnum =</span> <span class="dv">2</span>) <span class="op">%&gt;&gt;%</span></a>
<a class="sourceLine" id="cb308-2" data-line-number="2"><span class="st">  </span><span class="kw">gunion</span>(<span class="kw">list</span>(mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;scale&quot;</span>), mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;pca&quot;</span>))) <span class="op">%&gt;&gt;%</span></a>
<a class="sourceLine" id="cb308-3" data-line-number="3"><span class="st">  </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;featureunion&quot;</span>, <span class="dt">innum =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb308-4" data-line-number="4"></a>
<a class="sourceLine" id="cb308-5" data-line-number="5">gr<span class="op">$</span><span class="kw">plot</span>(<span class="dt">html =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div id="htmlwidget-0dd7a95656bd7a9f34bc" style="width:50%;height:400px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-0dd7a95656bd7a9f34bc">{"x":{"nodes":{"id":["copy","scale","pca","<INPUT>","featureunion","<OUTPUT>"],"label":["copy","scale","pca","<INPUT>","featureunion","<OUTPUT>"],"shape":["box","box","box","database","box","ellipse"],"color":["lightblue","lightblue","lightblue","rgba(0,204,102,0.2)","lightblue","rgba(255,51,51,0.2)"],"value":[1,1,1,0.8,1,0.8],"title":["<p>PipeOp: <b>copy<\/b> (not trained)<br>values: <b>list()<\/b><br>Input channels <b>name [train type, predict type]<\/b>:<br>  input [*,*]<br>Output channels <b>name [train type, predict type]<\/b>:<br>  output1 [*,*], output2 [*,*]<\/p>","<p>PipeOp: <b>scale<\/b> (not trained)<br>values: <b>list()<\/b><br>Input channels <b>name [train type, predict type]<\/b>:<br>  input [Task,Task]<br>Output channels <b>name [train type, predict type]<\/b>:<br>  output [Task,Task]<\/p>","<p>PipeOp: <b>pca<\/b> (not trained)<br>values: <b>list()<\/b><br>Input channels <b>name [train type, predict type]<\/b>:<br>  input [Task,Task]<br>Output channels <b>name [train type, predict type]<\/b>:<br>  output [Task,Task]<\/p>","<p>Input:<br>Name: copy.input<br>Train: *<br>Predict: *<\/p>","<p>PipeOp: <b>featureunion<\/b> (not trained)<br>values: <b>list()<\/b><br>Input channels <b>name [train type, predict type]<\/b>:<br>  input1 [Task,Task], input2 [Task,Task]<br>Output channels <b>name [train type, predict type]<\/b>:<br>  output [Task,Task]<\/p>","<p>Output:<br>Name: featureunion.output<br>Train: Task<br>Predict: Task<\/p>"],"x":[0,-1,1,0,0,0],"y":[-0.5,0,0,-1,0.5,1]},"edges":{"from":["copy","copy","scale","pca","<INPUT>","featureunion"],"to":["scale","pca","featureunion","featureunion","copy","<OUTPUT>"],"color":["lightblue","lightblue","lightblue","lightblue","lightblue","lightblue"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"to","smooth":{"enabled":false,"forceDirection":"vertical"}},"physics":{"stabilization":false}},"groups":null,"width":"50%","height":"400px","idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"full"}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="pipeop-ids-and-id-name-clashes" class="section level4">
<h4><span class="header-section-number">4.7.4.4</span> <code>PipeOp</code> IDs and ID Name Clashes</h4>
<p><code>PipeOp</code>s within a graph are addressed by their <strong><code>$id</code></strong>-slot.
It is therefore necessary for all <code>PipeOp</code>s within a <code>Graph</code> to have a unique <code>$id</code>.
The <code>$id</code> can be set during or after construction, but it should not directly be changed after a <code>PipeOp</code> was inserted in a <code>Graph</code>.
At that point, the <strong><code>$set_names()</code></strong>-method can be used to change <code>PipeOp</code> ids.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" data-line-number="1">po1 =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;scale&quot;</span>)</a>
<a class="sourceLine" id="cb309-2" data-line-number="2">po2 =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;scale&quot;</span>)</a>
<a class="sourceLine" id="cb309-3" data-line-number="3">po1 <span class="op">%&gt;&gt;%</span><span class="st"> </span>po2  ## name clash</a></code></pre></div>
<pre><code>## Error in gunion(list(g1, g2)): Assertion on &#39;ids of pipe operators&#39; failed: Must have unique names, but element 2 is duplicated.</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" data-line-number="1">po2<span class="op">$</span>id =<span class="st"> &quot;scale2&quot;</span></a>
<a class="sourceLine" id="cb311-2" data-line-number="2">gr =<span class="st"> </span>po1 <span class="op">%&gt;&gt;%</span><span class="st"> </span>po2</a>
<a class="sourceLine" id="cb311-3" data-line-number="3">gr</a></code></pre></div>
<pre><code>## Graph with 2 PipeOps:
##      ID         State sccssors prdcssors
##   scale &lt;&lt;UNTRAINED&gt;&gt;   scale2          
##  scale2 &lt;&lt;UNTRAINED&gt;&gt;              scale</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" data-line-number="1">## Alternative ways of getting new ids:</a>
<a class="sourceLine" id="cb313-2" data-line-number="2">mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;scale&quot;</span>, <span class="dt">id =</span> <span class="st">&quot;scale2&quot;</span>)</a></code></pre></div>
<pre><code>## PipeOp: &lt;scale2&gt; (not trained)
## values: &lt;list()&gt;
## Input channels &lt;name [train type, predict type]&gt;:
##   input [Task,Task]
## Output channels &lt;name [train type, predict type]&gt;:
##   output [Task,Task]</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" data-line-number="1">PipeOpScale<span class="op">$</span><span class="kw">new</span>(<span class="dt">id =</span> <span class="st">&quot;scale2&quot;</span>)</a></code></pre></div>
<pre><code>## PipeOp: &lt;scale2&gt; (not trained)
## values: &lt;list()&gt;
## Input channels &lt;name [train type, predict type]&gt;:
##   input [Task,Task]
## Output channels &lt;name [train type, predict type]&gt;:
##   output [Task,Task]</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" data-line-number="1">## sometimes names of PipeOps within a Graph need to be changed</a>
<a class="sourceLine" id="cb317-2" data-line-number="2">gr2 =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;scale&quot;</span>) <span class="op">%&gt;&gt;%</span><span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;pca&quot;</span>)</a>
<a class="sourceLine" id="cb317-3" data-line-number="3">gr <span class="op">%&gt;&gt;%</span><span class="st"> </span>gr2</a></code></pre></div>
<pre><code>## Error in gunion(list(g1, g2)): Assertion on &#39;ids of pipe operators&#39; failed: Must have unique names, but element 3 is duplicated.</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" data-line-number="1">gr2<span class="op">$</span><span class="kw">set_names</span>(<span class="st">&quot;scale&quot;</span>, <span class="st">&quot;scale3&quot;</span>)</a>
<a class="sourceLine" id="cb319-2" data-line-number="2">gr <span class="op">%&gt;&gt;%</span><span class="st"> </span>gr2</a></code></pre></div>
<pre><code>## Graph with 4 PipeOps:
##      ID         State sccssors prdcssors
##   scale &lt;&lt;UNTRAINED&gt;&gt;   scale2          
##  scale2 &lt;&lt;UNTRAINED&gt;&gt;   scale3     scale
##  scale3 &lt;&lt;UNTRAINED&gt;&gt;      pca    scale2
##     pca &lt;&lt;UNTRAINED&gt;&gt;             scale3</code></pre>
</div>
</div>
<div id="learners-in-graphs-graphs-in-learners" class="section level3">
<h3><span class="header-section-number">4.7.5</span> Learners in Graphs, Graphs in Learners</h3>
<p>The true power of <a href="https://cran.r-project.org/package=mlr3pipelines">mlr3pipelines</a> derives from the fact that it can be integrated seamlessly with <code>mlr3</code>.
Two components are mainly responsible for this:</p>
<ul>
<li><strong><code>PipeOpLearner</code></strong>, a <code>PipeOp</code> that encapsulates a <code>mlr3</code> <code>Learner</code> and creates a <code>PredictionData</code> object in its <code>$predict()</code> phase</li>
<li><strong><code>GraphLearner</code></strong>, a <code>mlr3</code> <code>Learner</code> that can be used in place of any other <code>mlr3</code> <code>Learner</code>, but which does prediction using a <code>Graph</code> given to it</li>
</ul>
<p>Note that these are dual to each other: One takes a <code>Learner</code> and produces a <code>PipeOp</code> (and by extension a <code>Graph</code>); the other takes a <code>Graph</code> and produces a <code>Learner</code>.</p>
<div id="pipeoplearner" class="section level4">
<h4><span class="header-section-number">4.7.5.1</span> <code>PipeOpLearner</code></h4>
<p>The <code>PipeOpLearner</code> is constructed using a <code>mlr3</code> <code>Learner</code> and will use it to create <code>PredictionData</code> in the <code>$predict()</code> phase.
The output during <code>$train()</code> is <code>NULL</code>.
It can be used after a preprocessing pipeline, and it is even possible to perform operations on the <code>PredictionData</code>, for example by averaging multiple predictions or by using the “<code>PipeOpBackupLearner</code>” operator to impute predictions that a given model failed to create.</p>
<p>The following is a very simple <code>Graph</code> that performs training and prediction on data after performing principal component analysis.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" data-line-number="1">gr =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;pca&quot;</span>) <span class="op">%&gt;&gt;%</span><span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;learner&quot;</span>,</a>
<a class="sourceLine" id="cb321-2" data-line-number="2">  mlr_learners<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;classif.rpart&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" data-line-number="1">gr<span class="op">$</span><span class="kw">train</span>(task)</a></code></pre></div>
<pre><code>## $classif.rpart.output
## NULL</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" data-line-number="1">gr<span class="op">$</span><span class="kw">predict</span>(task)</a></code></pre></div>
<pre><code>## $classif.rpart.output
## &lt;PredictionClassif&gt; for 150 observations:
##     row_id     truth  response
##          1    setosa    setosa
##          2    setosa    setosa
##          3    setosa    setosa
## ---                           
##        148 virginica virginica
##        149 virginica virginica
##        150 virginica virginica</code></pre>
</div>
<div id="graphlearner" class="section level4">
<h4><span class="header-section-number">4.7.5.2</span> <code>GraphLearner</code></h4>
<p>Although a <code>Graph</code> has <code>$train()</code> and <code>$predict()</code> functions, it can not be used directly in places where <code>mlr3</code> <code>Learners</code> can be used like resampling or benchmarks.
For this, it needs to be wrapped in a <code>GraphLearner</code> object, which is a thin wrapper that enables this functionality.
The resulting <code>Learner</code> is extremely versatile, because every part of it can be modified, replaced, parameterized and optimized over.
Resampling the graph above can be done the same way that resampling of the <code>Learner</code> was performed in the <a href="advanced-an-in-depth-look-into-mlr3pipelines.html#whats-the-point">introductory example</a>.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" data-line-number="1">lrngrph =<span class="st"> </span>GraphLearner<span class="op">$</span><span class="kw">new</span>(gr)</a>
<a class="sourceLine" id="cb326-2" data-line-number="2"><span class="kw">resample</span>(task, lrngrph, rsmp)</a></code></pre></div>
<pre><code>## &lt;ResampleResult&gt; of 1 iterations
## * Task: iris
## * Learner: pca.classif.rpart
## * Warnings: 0 in 0 iterations
## * Errors: 0 in 0 iterations</code></pre>
</div>
</div>
<div id="hyperparameters" class="section level3">
<h3><span class="header-section-number">4.7.6</span> Hyperparameters</h3>
<p><a href="https://cran.r-project.org/package=mlr3pipelines">mlr3pipelines</a> relies on the <a href="https://paradox.mlr-org.com"><code>paradox</code></a> package to provide parameters that can modify each <code>PipeOp</code>’s behavior.
<code>paradox</code> parameters provide information about the parameters that can be changed, as well as their types and ranges.
They provide a unified interface for benchmarks and parameter optimization (“tuning”).
For a deep dive into <code>paradox</code>, see the <a href="https://mlr3book.mlr-org.com">mlr3book</a>.</p>
<p>The <code>ParamSet</code>, representing the space of possible parameter configurations of a <code>PipeOp</code>, can be inspected by accessing the <strong><code>$param_set</code></strong> slot of a <code>PipeOp</code> or a <code>Graph</code>.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" data-line-number="1">op_pca =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;pca&quot;</span>)</a>
<a class="sourceLine" id="cb328-2" data-line-number="2">op_pca<span class="op">$</span>param_set</a></code></pre></div>
<pre><code>## ParamSet: pca
##                id    class lower upper      levels    default value
## 1:         center ParamLgl    NA    NA  TRUE,FALSE       TRUE      
## 2:         scale. ParamLgl    NA    NA  TRUE,FALSE      FALSE      
## 3:          rank. ParamInt     1   Inf                             
## 4: affect_columns ParamUty    NA    NA             &lt;Selector&gt;</code></pre>
<p>To set or retrieve a parameter, the <strong><code>$param_set$values</code></strong> slot can be accessed.
Alternatively, the <code>param_vals</code> value can be given during construction.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" data-line-number="1">op_pca<span class="op">$</span>param_set<span class="op">$</span>values<span class="op">$</span>center =<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb330-2" data-line-number="2">op_pca<span class="op">$</span>param_set<span class="op">$</span>values</a></code></pre></div>
<pre><code>## $center
## [1] FALSE</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" data-line-number="1">op_pca =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;pca&quot;</span>, <span class="dt">param_vals =</span> <span class="kw">list</span>(<span class="dt">center =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb332-2" data-line-number="2">op_pca<span class="op">$</span>param_set<span class="op">$</span>values</a></code></pre></div>
<pre><code>## $center
## [1] TRUE</code></pre>
<p>Each <code>PipeOp</code> can bring its own individual parameters which are collected together in the <code>Graph</code>’s <code>$param_set</code>.
A <code>PipeOp</code>’s parameter names are prefixed with its <code>$id</code> to prevent parameter name clashes.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" data-line-number="1">gr =<span class="st"> </span>op_pca <span class="op">%&gt;&gt;%</span><span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;scale&quot;</span>)</a>
<a class="sourceLine" id="cb334-2" data-line-number="2">gr<span class="op">$</span>param_set</a></code></pre></div>
<pre><code>## ParamSet: 
##                      id    class lower upper      levels    default value
## 1:           pca.center ParamLgl    NA    NA  TRUE,FALSE       TRUE  TRUE
## 2:           pca.scale. ParamLgl    NA    NA  TRUE,FALSE      FALSE      
## 3:            pca.rank. ParamInt     1   Inf                             
## 4:   pca.affect_columns ParamUty    NA    NA             &lt;Selector&gt;      
## 5:         scale.center ParamLgl    NA    NA  TRUE,FALSE       TRUE      
## 6:          scale.scale ParamLgl    NA    NA  TRUE,FALSE       TRUE      
## 7: scale.affect_columns ParamUty    NA    NA             &lt;Selector&gt;</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" data-line-number="1">gr<span class="op">$</span>param_set<span class="op">$</span>values</a></code></pre></div>
<pre><code>## $pca.center
## [1] TRUE</code></pre>
<p>Both <code>PipeOpLearner</code> and <code>GraphLearner</code> preserve parameters of the objects they encapsulate.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb338-1" data-line-number="1">op_rpart =<span class="st"> </span>mlr_pipeops<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;learner&quot;</span>, mlr_learners<span class="op">$</span><span class="kw">get</span>(<span class="st">&quot;classif.rpart&quot;</span>))</a>
<a class="sourceLine" id="cb338-2" data-line-number="2">op_rpart<span class="op">$</span>param_set</a></code></pre></div>
<pre><code>## ParamSet: classif.rpart
##                id    class lower upper levels     default value
## 1:       minsplit ParamInt     1   Inf                 20      
## 2:      minbucket ParamInt     1   Inf        &lt;NoDefault&gt;      
## 3:             cp ParamDbl     0     1               0.01      
## 4:     maxcompete ParamInt     0   Inf                  4      
## 5:   maxsurrogate ParamInt     0   Inf                  5      
## 6:       maxdepth ParamInt     1    30                 30      
## 7:   usesurrogate ParamInt     0     2                  2      
## 8: surrogatestyle ParamInt     0     1                  0      
## 9:           xval ParamInt     0   Inf                 10     0</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" data-line-number="1">glrn =<span class="st"> </span>GraphLearner<span class="op">$</span><span class="kw">new</span>(gr <span class="op">%&gt;&gt;%</span><span class="st"> </span>op_rpart)</a>
<a class="sourceLine" id="cb340-2" data-line-number="2">glrn<span class="op">$</span>param_set</a></code></pre></div>
<pre><code>## ParamSet: 
##                               id    class lower upper      levels     default
##  1:                   pca.center ParamLgl    NA    NA  TRUE,FALSE        TRUE
##  2:                   pca.scale. ParamLgl    NA    NA  TRUE,FALSE       FALSE
##  3:                    pca.rank. ParamInt     1   Inf                        
##  4:           pca.affect_columns ParamUty    NA    NA              &lt;Selector&gt;
##  5:                 scale.center ParamLgl    NA    NA  TRUE,FALSE        TRUE
##  6:                  scale.scale ParamLgl    NA    NA  TRUE,FALSE        TRUE
##  7:         scale.affect_columns ParamUty    NA    NA              &lt;Selector&gt;
##  8:       classif.rpart.minsplit ParamInt     1   Inf                      20
##  9:      classif.rpart.minbucket ParamInt     1   Inf             &lt;NoDefault&gt;
## 10:             classif.rpart.cp ParamDbl     0     1                    0.01
## 11:     classif.rpart.maxcompete ParamInt     0   Inf                       4
## 12:   classif.rpart.maxsurrogate ParamInt     0   Inf                       5
## 13:       classif.rpart.maxdepth ParamInt     1    30                      30
## 14:   classif.rpart.usesurrogate ParamInt     0     2                       2
## 15: classif.rpart.surrogatestyle ParamInt     0     1                       0
## 16:           classif.rpart.xval ParamInt     0   Inf                      10
##     value
##  1:  TRUE
##  2:      
##  3:      
##  4:      
##  5:      
##  6:      
##  7:      
##  8:      
##  9:      
## 10:      
## 11:      
## 12:      
## 13:      
## 14:      
## 15:      
## 16:     0</code></pre>

</div>
</div>
<!-- </div> -->
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>It is tempting to denote this as a “directed acyclic graph”, but this would not be entirely correct because edges run between channels of <code>PipeOp</code>s, not <code>PipeOp</code>s themselves.<a href="advanced-an-in-depth-look-into-mlr3pipelines.html#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pipe-special-ops.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="technical.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mlr-org/mlr3book/edit/master/bookdown/04-pipelines.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/mlr-org/mlr3book/commits/master/04-pipelines.Rmd",
"text": "Edit history"
},
"view": {
"link": null,
"text": null
},
"download": [["mlr3book.pdf", "PDF"]],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
